<!DOCTYPE html>
<html>
  <head>
  	<meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1.0">
  	<style type="text/css">
  	/* TENEMOS QUE DARLE UN TAMAÑO AL DIV QUE CONTIENE EL MAPA. SI NO, NO SE VERÁ  */
      #divmapa {
      	width: 700px;
      	height: 700px;
      	border: 1px solid blue; 
     	}
    </style>
  	
    <title>API v3 de Google Maps. Ejemplo Básico 3</title>
    
    <script type="text/javascript" 
    	src="http://maps.google.com/maps/api/js?key=AIzaSyB5KWBzrJvp3Pzrg6ilHkF4O1zFSTVmfjE">
    </script>
    
    <script type="text/javascript">
      
      function CargarMapa() {
        var mapa;
        var centro;
      	var divMapa = document.getElementById("divmapa");
      	
      	var opciones = {
		    zoom: 17,	
		};
				
      	mapa = new google.maps.Map(divMapa, opciones);


        if (navigator.geolocation) {
      		var geo = navigator.geolocation;
      		geo.getCurrentPosition(muestraLoc, muestraErr);
      	}

          function muestraLoc(pos) {
            var lat = pos.coords.latitude;
            var lon = pos.coords.longitude;

            centro = new google.maps.LatLng(lat, lon);
            mapa.setCenter(centro);
      }
      
      function muestraErr(error) {
      	var errores = { 
    			1: 'Permission denied',
    			2: 'Position unavailable',
    			3: 'Request timeout'
  			};
      	document.getElementById("info").innerHTML += "<br /> Ha habido un ERROR. " + errores[error.code];
      }
      	
      	
      	//  Le colocamos un marcador:
      	var marcador = new google.maps.Marker({
      		position: centro,
      		map: mapa,
      		title:"IES Velazquez"
  			});
  			
  			//  Le ponemos una ventanica de información:
  			var infowindow = new google.maps.InfoWindow({
        	map: mapa,
        	position: centro,
        	content: 'Aquí es donde se viene a sufrir'
      	});

      }
      
    </script>
  </head>
  
  <body>
    <h3>API v3 de Google Maps. Ejemplo Básico 3</h3>
    <h5>En esta versión, le añadimos una ventanica de información.</h5>
    <p>
    	<button id="btCargarMapa" onclick="CargarMapa()">Cargar Mapa</button>
    </p>
    <p>
    	<div id="divmapa">
    		Aquí pondremos el mapa
    	</div>
    </p>
  </body>
  
</html>
