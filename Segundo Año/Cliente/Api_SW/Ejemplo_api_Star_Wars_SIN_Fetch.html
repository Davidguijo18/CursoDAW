<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<title>Envio de parametros con AJAX externo</title>
	<style type="text/css">
		body {
			background: url(sw.avif) no-repeat;
			text-align: center;
		}

		table {
			margin: auto;
			margin-top: 70px;
			border-radius: 15px;
		}

		h3 {
			margin: auto;
			color: #ffd000;
			font-size: larger;
		}

		.estilo_Tabla_1 {
			font-family: "Trebuchet MS", Arial, Helvetica, sans-serif;
			width: 70%;
			border-collapse: collapse;
		}

		.estilo_Tabla_1 td {
			font-size: 1em;
			border: 1px solid #000000;
			padding: 4px;
		}

		.estilo_Tabla_1 th {
			border: 1px solid #000000;
			font-size: 1.2em;
			padding: 5px;
			background-color: #000000;
			color: #ffd000;
		}

		.estilo_Tabla_1 tr td {
			color: #000000;
			background-color: #cf0b0b;
		}

		.estilo_Tabla_1 tr td:nth-child(-n+3) {
			color: #000000;
			background-color: rgb(59, 59, 228);
		}

		.estilo_Tabla_1 tr td:nth-child(5).horizontal-gradient {
			background: linear-gradient(to right, blue, rgb(255, 0, 43));
		}

		caption {
			caption-side: bottom;
			color: #ffd000;
			font-size: large;
			background-color: #000000;
			padding-bottom: 10px;
			padding-top: 10px;
			align-items: center;
		}

        h3{
		margin: auto;
	}

	.botones input{
		width: 8em;
		height: 4em;
		border-radius: 3em;
		font-size: large;
		background-color: #000000;
		color: #ffd000;
		margin-right: 40px;
	}

		#datosPlaneta, #datosPlaneta ul {
			color: white;
			list-style-type: none;
		}

	</style>

	<script type="text/javascript">
		var urlPersonajes = 'https://swapi.dev/api/people/?format=json';
		var enlaceAnterior = null;
		var enlacePosterior = null;

		window.onload = function () {
			cargarPersonajes(urlPersonajes);

			document.getElementById("siguiente").onclick = function() {
				if (enlacePosterior) cargarPersonajes(enlacePosterior);
			};
			
			document.getElementById("anterior").onclick = function() {
				if (enlaceAnterior) cargarPersonajes(enlaceAnterior);
			};
		}

		// Cargar personajes de la API y mostrar en tabla
		function cargarPersonajes(url) {
			fetch(url)
				.then(respuesta => respuesta.json())
				.then(personajes => {
					enlaceAnterior = personajes.previous;
					enlacePosterior = personajes.next;

					const tabla = document.getElementById("cuerpoPersonajes");
					tabla.innerHTML = "";

					personajes.results.forEach(personaje => {
						const fila = document.createElement("tr");

						const datosPersonaje = [
							personaje.name,
							personaje.height,
							personaje.mass,
							personaje.birth_year,
							personaje.gender,
							personaje.homeworld
						];

						datosPersonaje.forEach(dato => {
							const columna = document.createElement("td");
							if (dato === personaje.homeworld) {
								const enlace = document.createElement("a");
								enlace.href = dato;
								enlace.innerHTML = dato;
								enlace.onclick = function(e) {
									e.preventDefault();
									cargarPlaneta(this.href);
								};
								columna.appendChild(enlace);
							} else {
								columna.innerHTML = dato;
							}
							fila.appendChild(columna);
						});
						tabla.appendChild(fila);
					});
				})
				.catch(error => console.log('Error en la solicitud:', error));
		}

		// Cargar datos del planeta y mostrar en el div
		function cargarPlaneta(url) {
			fetch(url)
				.then(respuesta => respuesta.json())
				.then(planeta => {
					const planetasDiv = document.getElementById("datosPlaneta");
					planetasDiv.innerHTML = "";

					const datosPlaneta = [
						"Nombre: " + planeta.name,
						"Periodo de rotación: " + planeta.rotation_period,
						"Periodo orbital: " + planeta.orbital_period,
						"Diámetro: " + planeta.diameter,
						"Clima: " + planeta.climate,
						"Gravedad: " + planeta.gravity,
						"Terreno: " + planeta.terrain
					];

					const lista = document.createElement("ul");
					datosPlaneta.forEach(elemento => {
						const itemLista = document.createElement("li");
						itemLista.innerHTML = elemento;
						lista.appendChild(itemLista);
					});

					planetasDiv.appendChild(lista);
				})
				.catch(error => console.log('Error al cargar el planeta:', error));
		}
	</script>
</head>

<body>
	<h3>Ejemplo de llamada a la API de STAR WARS</h3>
	<br/>

	<p>
		<table id="personajes" class="estilo_Tabla_1">
			<caption>Personajes STAR WARS</caption>
			<thead>
				<tr>
					<th>Nombre</th>
					<th>Altura</th>
					<th>Peso</th>
					<th>Nacimiento</th>
					<th>Género</th>
					<th>Homeworld</th>
				</tr>
			</thead>
			<tbody id="cuerpoPersonajes"></tbody>
		</table>
	</p>

	<br>
	<div class="botones">
		<input type="button" name="anterior" id="anterior" value="Anterior">
		<input type="button" name="siguiente" id="siguiente" value="Siguiente">
	</div>
	
	<br/>
	<!-- Div donde se mostrará la información del planeta -->
	<div id="datosPlaneta">Datos del planeta:</div>
</body>
</html>
