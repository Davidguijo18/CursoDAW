/*DAVID GUIJO LOPEZ*/

/*1- CREACION DE TABLAS*/

/*TABLA JUGADOR*/
CREATE TABLE DGL_JUGADOR(
CODIGO_J NUMBER(5),
NOMBRE VARCHAR2(15),
POSICION VARCHAR2(20),
FECHANAC DATE,

CONSTRAINT JUG_COD_PK PRIMARY KEY(CODIGO_J),

CONSTRAINT JUG_POS_CH CHECK (POSICION IN('Portero','Defensa','Centrocampista','Delantero'))
);


/*TABLA GOLES*/
CREATE TABLE DGL_GOLES(
CODPARTIDO NUMBER(4),
CODJUGADOR NUMBER(5),
MINUTO NUMBER(3),
DESCRIPCION VARCHAR2(70),

CONSTRAINT GOL_CODPJ_PK PRIMARY KEY(CODPARTIDO,CODJUGADOR),

CONSTRAINT GOL_CODP_FK FOREIGN KEY(CODPARTIDO)
    REFERENCES DGL_PARTIDO ON DELETE CASCADE,
CONSTRAINT GOL_CODJ_FK FOREIGN KEY(CODJUGADOR)
    REFERENCES DGL_JUGADOR ON DELETE CASCADE,
    
CONSTRAINT GOL_MIN_CH CHECK(MINUTO<100)
);


/*TABLA PARTIDO*/
CREATE TABLE DGL_PARTIDO(
COD_P NUMBER(4),
FECHA DATE,
EQLOCAL NUMBER(5),
EQVISITANTE NUMBER(5),

CONSTRAINT PAR_COD_PK PRIMARY KEY(COD_P),

CONSTRAINT PAR_EQL_FK FOREIGN KEY(EQLOCAL)
    REFERENCES DGL_EQUIPO ON DELETE CASCADE,
CONSTRAINT PAR_EQV_FK FOREIGN KEY(EQVISITANTE)
    REFERENCES DGL_EQUIPO ON DELETE CASCADE
);


/*TABLA EQUIPO*/
CREATE TABLE DGL_EQUIPO(
CODIGO_E NUMBER(5),
NOMBRE  VARCHAR(15) UNIQUE,
ESTADIO VARCHAR(20),
AFORO NUMBER(5) DEFAULT 0,
CIUDAD VARCHAR(20),

CONSTRAINT EQU_COD_PK PRIMARY KEY(CODIGO_E)
);


/*TABLA PRESIDENTE*/
CREATE TABLE DGL_PRESIDENTE(
DNI VARCHAR2(9),
NOMBRE VARCHAR2(15),
APELLIDOS VARCHAR2(20),
FECHAELECCION DATE,
FECHANAC DATE,
EQUIPO NUMBER(5) UNIQUE,

CONSTRAINT PRE_DNI_PK PRIMARY KEY(DNI),

CONSTRAINT PRE_EQU_FK FOREIGN KEY(EQUIPO)
    REFERENCES DGL_EQUIPO ON DELETE CASCADE
);




/*2-MODIFICACION DE TABLAS*/

ALTER TABLE DGL_EQUIPO ADD(
NUMITULOS NUMBER(2)
);

ALTER TABLE DGL_EQUIPO DROP (CIUDAD);

ALTER TABLE DGL_EQUIPO ADD(
AÑO_FUNDACION NUMBER(4),

CONSTRAINT EQU_FEC_CH CHECK(AÑO_FUNDACION<1890)
);

ALTER TABLE DGL_EQUIPO ADD(
CONSTRAINT EQU_NOM_CH CHECK (NOMBRE=UPPER(NOMBRE))
);

/*3-ELIMINACION DE TABLAS*/
DROP TABLE DGL_GOLES;
DROP TABLE DGL_JUGADOR;
DROP TABLE DGL_PARTIDO;
DROP TABLE DGL_PRESIDENTE;
DROP TABLE DGL_EQUIPO;