/*DAVID GUIJO LÃ“PEZ*/


/*TABLA SUCURSAL*/
CREATE TABLE DGL_SUCURSAL(
CODIGO NUMBER(5),
DIRECCION VARCHAR2(20),
TELEFONO NUMBER(9),
CIUDAD VARCHAR2(15),
PROVINCIA VARCHAR(12),

CONSTRAINT SUC_COD_PK PRIMARY KEY(CODIGO)
);

   ALTER TABLE DGL_SUCURSAL MODIFY(
    CONSTRAINT SUC_COD_CH CHECK (CODIGO IN('s01','s02','s03'))
    );
 



/*TABLA EMPLEADO*/
CREATE TABLE DGL_EMPLEADO(
ID_EMPLEADO VARCHAR2(4),
NIF VARCHAR2(9),
NOMBRE VARCHAR2(15),
APELLIDO1 VARCHAR2(15),
APELLIDO2 VARCHAR2(15),
TELEFONO NUMBER(9),
CODIGO NUMBER(5),

CONSTRAINT EMP_IDEMP_PK PRIMARY KEY(ID_EMPLEADO),

CONSTRAINT EMP_COD_FK FOREIGN KEY(CODIGO)
    REFERENCES DGL_SUCURSAL ON DELETE CASCADE
);

    ALTER TABLE DGL_EMPLEADO MODIFY(
    NOMBRE VARCHAR2(15)NOT NULL
    );




/*TABLA PUBLICA*/
CREATE TABLE DGL_PUBLICA(
CODIGO NUMBER(5),
ID_REVISTA NUMBER(5),

CONSTRAINT PUB_IDCOD_PK PRIMARY KEY(CODIGO,ID_REVISTA),

CONSTRAINT PUB_COD_FK FOREIGN KEY(CODIGO)
    REFERENCES DGL_SUCURSAL ON DELETE CASCADE,
    
CONSTRAINT PUB_IDREV_FK FOREIGN KEY(ID_REVISTA)
    REFERENCES DGL_REVISTA ON DELETE CASCADE
);




/*TABLA REVISTA*/
CREATE TABLE DGL_REVISTA(
ID_REVISTA NUMBER(5),
TITULO VARCHAR2(12),
TIPO VARCHAR2(12),
PERIODICIDAD VARCHAR(15) DEFAULT 'mensual',

CONSTRAINT REV_IDREV_PK PRIMARY KEY(ID_REVISTA),

CONSTRAINT REV_PER_CH CHECK (PERIODICIDAD IN('semanal','quincenal','mensual','trimestral','anual'))
);

    ALTER TABLE DGL_REVISTA MODIFY(
    TITULO VARCHAR2(12)NOT NULL
    );




/*TABLA ESCRIBE*/
CREATE TABLE DGL_ESCRIBE(
ID_REVISTA NUMBER(5),
ID_PERIODISTA NUMBER(6),

CONSTRAINT ESC_IDREPE_PK PRIMARY KEY(ID_REVISTA,ID_PERIODISTA),

CONSTRAINT ESC_IDREV_FK FOREIGN KEY(ID_REVISTA)
    REFERENCES DGL_REVISTA ON DELETE CASCADE,
    
CONSTRAINT ESC_IDPER_FK FOREIGN KEY(ID_PERIODISTA)
    REFERENCES DGL_PERIODISTA ON DELETE CASCADE
);




/*TABLA PERIODISTA*/
CREATE TABLE DGL_PERIODISTA(
ID_PERIODISTA NUMBER(6),
NOMBRE VARCHAR2(15),
APELLIDO1 VARCHAR2(15),
APELLIDO2 VARCHAR2(15),
ESPECIALIDAD VARCHAR2(15),

CONSTRAINT PER_IDPER_PK PRIMARY KEY(ID_PERIODISTA)
);

    ALTER TABLE DGL_PERIODISTA MODIFY(
    NOMBRE VARCHAR2(15)NOT NULL
    );




/*TABLA TELEFONO_PERIODISTA*/
CREATE TABLE DGL_TELEFONOPERIODISTA(
TELEFONO NUMBER(9),
ID_PERIODISTA NUMBER(6),

CONSTRAINT TELPER_IDTEL_PK PRIMARY KEY(TELEFONO,ID_PERIODISTA),

CONSTRAINT TELPER_IDPER_FK FOREIGN KEY(ID_PERIODISTA)
    REFERENCES DGL_PERIODISTA ON DELETE CASCADE
);




/*TABLA SECCION*/
CREATE TABLE DGL_SECCION(
ID_SECCION NUMBER(5),
TITULO VARCHAR2(15),
DESCRIPCION VARCHAR2(50),
ID_REVISTA NUMBER(5),

CONSTRAINT SEC_IDSEC_PK PRIMARY KEY(ID_SECCION),

CONSTRAINT SEC_IDREV_FK FOREIGN KEY(ID_REVISTA)
    REFERENCES DGL_REVISTA ON DELETE CASCADE
);




/*TABLA EJEMPLAR*/
CREATE TABLE DGL_EJEMPLAR(
ID_EJEMPLAR NUMBER(5),
FECHA DATE,
NUMERO_EJEMPLARES NUMBER(4),
NUMERO_PAGINAS NUMBER(4),
ID_REVISTA NUMBER(5),

CONSTRAINT EJEM_IDEJEM_PK PRIMARY KEY(ID_EJEMPLAR),

CONSTRAINT EJEM_IDREV_FK FOREIGN KEY(ID_REVISTA)
    REFERENCES DGL_REVISTA ON DELETE CASCADE
);

    ALTER TABLE DGL_EJEMPLAR MODIFY(
    CONSTRAINT EJEM_NUMPA_CH CHECK(NUMERO_PAGINAS>0),
    CONSTRAINT EJEM_NUMEJ_CH CHECK(NUMERO_EJEMPLARES>0)
    );

